<!DOCTYPE html>
<html lang="en">
	<head>
    <link href="https://fonts.googleapis.com/css2?family=Six+Caps&display=swap" rel="stylesheet">

		<meta charset="utf-8">
		<title>Portfolio Vale Alvarez</title>

		<link rel="stylesheet" href="Public/index.css">

    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@v0.163.0/build/three.module.js",
          "three/addons/": "https://unpkg.com/three@v0.163.0/examples/jsm/"
        }
      }
    </script>
    
	</head>
    <link rel="preload" href="Images/CocinaDiaVideo.mp4" as="video" type="video/mp4">
    <body id="top">
      <!-- Overlay aviso orientación -->
      <div id="rotateMessage">
        <div class="message-box">
          <div class="phone-icon">
            <div class="phone"></div>
            <div class="screen"></div>
          </div>
          <p>For a better experience, rotate your device.</p>
        </div>
      </div>
       <div id="page-wrapper">
      <!-- Pantalla de carga -->
       <div id="preloader">
        <div class="loader"> </div>
        <div id="progress-text">Loading Portfolio... 0%</div>
      </div>
      <div class="Fondo-Inicio">
        <video id="themeVideo" autoplay loop muted playsinline>
          <source src="Images/CocinaNocheVideo.mp4" type="video/mp4">
          <!-- Fallback: imagen si no soporta video -->
          <img src="Images/imagennoche.png" alt="Noche de fondo">
        </video>
        <img src="Images/3dartist.png" class="threedartist">
        <img src="Images/PortfoliTitle.png" class="Titul">
        <img src="Images/OTitle.png" class="Titulo">
        <img src="Images/Sol.png" class = LunaSol id="themeToggle">
        <div class="About-Me">
          <img src="Images/1.jpg" class="SobremiText">
          <div class="contenedor-blender">
            <img src="Images/BlenderLogo.png" class="Blender">
            <img src="Images/CuatroEstrellas.png" class="estrellas-Blender">
            <img src="Images/habilidadesBlender.png" class="habilidades-Blender">
          </div>
          <div class="contenedor-substance">
            <img src="Images/Substance.png" class="Substance">
            <img src="Images/CuatroEstrellas.png" class="estrellas-Substance">
            <img src="Images/habilidadesSubstance.png" class="habilidades-Substance">
          </div>
          <div class="contenedor-Clip">
            <img src="Images/Clip.png" class="Clip">
            <img src="Images/CuatroEstrellas.png" class="estrellas-Clip">
            <img src="Images/habilidadesClip.png" class="habilidades-Clip">
          </div>
          <img src="Images/2.jpg" class="Echoes1">
          <img src="Images/3.jpg" class="EchoesTitle">
          <div class="video-container-echoes">
            <iframe 
              src="https://www.youtube.com/embed/_k2y8_AW4do" 
              title="YouTube video"
              frameborder="0" 
              allow="encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen>
            </iframe>
          </div>
          <video class="mi-video" autoplay loop muted playsinline>
            <source src="Cabrera.webm" type="video/webm">
            Tu navegador no soporta video transparente.
          </video>
          <video class="mi-videochime" autoplay loop muted playsinline>
            <source src="SillaVale.webm" type="video/webm">
            Tu navegador no soporta video transparente.
          </video>
          <img src="Images/4.jpg" class="Echoes2">
          <img src="Images/5.jpg" class="Echoes3">
          <img src="Images/6.jpg" class="Echoes4">

          <img src="Images/7.jpg" class="Nox1">
          <img src="Images/8.jpg" class="Nox2">
          <div class="video-container">
            <iframe 
              src="https://www.youtube.com/embed/rsPubY8bLgo" 
              title="YouTube video"
              frameborder="0" 
              allow="encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen>
            </iframe>
          </div>
  </div>

    <footer class="site-footer">
      <a href="#top" class="footer-btn footer-name" title="Ir al inicio">
        Valeria Alvarez
      </a>
      <a href="mailto:valalvarios@gmail.com" class="footer-btn" title="Contact me">
        <i class="fas fa-envelope"></i>
      </a>
      <a href="Docs/CV_VALERIA ALVAREZ RIOS.pdf" class="footer-btn" title="Download my CV" download>
        <i class="fas fa-file-alt"></i>
      </a>
    </footer>

      <!-- Cargar Font Awesome para íconos -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


     <script>
      document.addEventListener("DOMContentLoaded", () => {
        const footer = document.querySelector(".site-footer");
        if (!footer) return; // si no existe, salimos sin errores

        // parámetros ajustables
        const nearBottomThreshold = 200; // px antes del final para forzar mostrar
        const minScrolledToTriggerOnUp = 100; // solo mostrar al subir si hemos bajado al menos esto

        // inicio: el último scroll es la posición actual (evita flash)
        let lastScroll = window.pageYOffset || 0;

        function handleScroll() {
          const currentScroll = window.pageYOffset || 0;
          const scrolledDownEnough = currentScroll > minScrolledToTriggerOnUp;
          const nearBottom = (currentScroll + window.innerHeight) >= (document.documentElement.scrollHeight - nearBottomThreshold);

          // prioridad: si estamos cerca del final, siempre mostrar
          if (nearBottom) {
            footer.classList.add("visible");
          }
          // si no estamos cerca del final: mostrar solo si scrolleamos hacia arriba
          else if (currentScroll < lastScroll && scrolledDownEnough) {
            footer.classList.add("visible");
          } else {
            footer.classList.remove("visible");
          }

          lastScroll = currentScroll;
        }

        // escuchador de scroll (passive para mejor rendimiento)
        window.addEventListener("scroll", handleScroll, { passive: true });

        // chequeo inicial por si el usuario carga ya cerca del final
        handleScroll();
      });
      </script>


      <script>
        const toggleBtn = document.getElementById("themeToggle");
        const themeImage = document.getElementById("themeVideo");

        function cambiarImagenSuave(imgElement, newSrc, duracion = 500) {
          // fade out
          imgElement.style.opacity = 0;

          setTimeout(() => {
            // cuando termina el fade out, cambiamos el src
            imgElement.src = newSrc;

            // esperamos a que la nueva imagen cargue antes de hacer fade in
            imgElement.onload = () => {
              imgElement.style.opacity = 1;
            };
          }, duracion);
        }

        function cambiarVideoSuave(videoElement, newSrc, duracion = 500) {
          // Guardar en qué segundo iba el video actual
          const tiempoActual = videoElement.currentTime;

          videoElement.style.opacity = 0;

          setTimeout(() => {
            videoElement.querySelector("source").src = newSrc;
            videoElement.load();

            // Cuando el nuevo video esté listo, saltamos al tiempo guardado
            videoElement.onloadeddata = () => {
              // Verificamos que no exceda la duración del nuevo video
              const nuevoTiempo = Math.min(tiempoActual, videoElement.duration || tiempoActual);
              videoElement.currentTime = nuevoTiempo;
              videoElement.play();
              videoElement.style.opacity = 1;
            };
          }, duracion);
        }

        
        let darkMode = false;

        toggleBtn.addEventListener("click", () => {
          darkMode = !darkMode;

          if (darkMode) {
            cambiarImagenSuave(toggleBtn,"Images/Luna.png");
            cambiarVideoSuave(themeVideo,"Images/CocinaDiaVideo.mp4");

          } else {
            cambiarImagenSuave(toggleBtn,"Images/Sol.png");
            cambiarVideoSuave(themeVideo,"Images/CocinaNocheVideo.mp4");
          }
        });
      </script>
      <script>
        function limitarResolucion() {
          if (window.innerWidth > 1440) {
            document.body.style.maxWidth = "1440px";   // límite
            document.body.style.margin = "0 auto";     // centrar
          } else {
            document.body.style.maxWidth = "100%";     // normal
            document.body.style.margin = "0";
          }
        }

        // ejecutar al cargar
        window.addEventListener("load", limitarResolucion);
        // ejecutar si redimensiona la ventana
        window.addEventListener("resize", limitarResolucion);
      </script>

     <script>
        function waitForVideo(videoElement) {
          return new Promise(resolve => {
            if (videoElement.readyState >= 3) {
              resolve();
            } else {
              videoElement.addEventListener("canplaythrough", resolve, { once: true });
            }
          });
        }

        function waitForImage(src) {
          return new Promise(resolve => {
            const img = new Image();
            img.onload = resolve;
            img.onerror = resolve; // aunque falle, lo contamos para no quedarnos atascados
            img.src = src;
          });
        }

        async function preloadResources() {
          const videoNoche = document.getElementById("themeVideo");
          const videoDia = document.createElement("video");
          videoDia.src = "Images/CocinaDiaVideo.mp4";
          videoDia.preload = "auto";

          // todas las imágenes usadas en el HTML
          const images = [
            "Images/imagennoche.png",
            "Images/3dartist.png",
            "Images/PortfoliTitle.png",
            "Images/OTitle.png",
            "Images/Sol.png",
            "Images/Luna.png",
            "Images/BlenderLogo.png",
            "Images/CuatroEstrellas.png",
            "Images/habilidadesBlender.png",
            "Images/Substance.png",
            "Images/habilidadesSubstance.png",
            "Images/Clip.png",
            "Images/habilidadesClip.png",
            "Images/1.jpg",
            "Images/2.jpg",
            "Images/3.jpg",
            "Images/4.jpg",
            "Images/5.jpg",
            "Images/6.jpg",
            "Images/7.jpg",
            "Images/8.jpg"
          ];

          // lista de promesas
          const resources = [
            waitForVideo(videoNoche),
            waitForVideo(videoDia),
            ...images.map(src => waitForImage(src))
          ];

          let loaded = 0;
          const total = resources.length;
          const progressText = document.getElementById("progress-text");

          // envolvemos cada recurso para actualizar el progreso cuando se cumpla
          const trackedResources = resources.map(promise =>
            promise.then(() => {
              loaded++;
              const percent = Math.round((loaded / total) * 100);
              progressText.textContent = `Loading Portfolio... ${percent}%`;
            })
          );

          await Promise.all(trackedResources);
        }

        window.addEventListener("load", async () => {
          const preloader = document.getElementById("preloader");

          await preloadResources();

          preloader.classList.add("hidden");
        });
     </script>

      <script>
        function checkScreenWidth() {
          const rotateMessage = document.getElementById("rotateMessage");

          // Normalizamos el ancho para que el zoom o la escala de Windows no afecten
          const realWidth = window.innerWidth * window.devicePixelRatio;

          if (realWidth < 1920) {
            rotateMessage.style.display = "flex";
          } else {
            rotateMessage.style.display = "none";
          }
        }

        window.addEventListener("load", checkScreenWidth);
        window.addEventListener("resize", checkScreenWidth);
      </script>

      <script type="module" src="./main.js"></script>
      <script src="golpe.js"></script>


    
    </body>




</html>
